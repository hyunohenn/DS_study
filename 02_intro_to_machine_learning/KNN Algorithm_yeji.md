# KNN Algorithm

## K-최근접이웃(K-Nearest Neighbor) 알고리즘 

![image-20210420010427372](C:\Users\yeahaluu\AppData\Roaming\Typora\typora-user-images\image-20210420010427372.png)

- 가까이 있는 것들이 세모니까 '?'도 세모라고 판단하는 알고리즘 --> 매우 간단하고 직관적

  

단순히 가장 가까이 있는 것을 선택하는 것이 옳은 분류일까?

![image-20210420010548637](C:\Users\yeahaluu\AppData\Roaming\Typora\typora-user-images\image-20210420010548637.png)

- '?' 에서 가장 가까운 것은 파란 동그라미지만 '?'이 파란색으로 보기엔 부적절하다

  -> 따라서 주변에 있는 여러개를 같이 봐서 가장 많은 것을 골라내는 방식이 KNN 이다. 이때 K는 주변의 개수를 의미한다

- k가 1이면 '?'은 파란 동그라미가 되겠지만, 4라면 빨간 세모라고 판달할 것이다.

- 이 때, k는 몇이어야 좋은 것일까?

  k 값이 커질수록 분류에서 이상치의 영향이 줄어든다. 하지만 분류 자체를 못하게 되는 상황이 발생한다. 일반적으로 총 데이터의 제곱근 값을 사용한다. (최적의 k 값을 찾는 것은 아직 연구 중)



## KNN 장단점

### 장점

1. 단순하고 효율적이다. 구현하기 쉽다 -> 게으른 학습(lazy learning) 이라고 표현하기도 한다
2. 훈련단계가 빠르다
   다른 머신러닝 알고리즘은 학습 데이터를 가지고 훈련 통해 모델을 생성, 하지만 K-NN 알고리즘은 훈련 데이터를 그대로 가지고만 있기 때문이다.

3. 수치 기반 데이터 분류 작업에서 성능이 우수하다

### 단점

1. 모델을 생성하지 않기 때문에 특징과 클래스 간 관계를 이해하는데 제한적이다.
   즉, 모델의 결과를 가지고 해석하는 것이 아니라 선험적으로 각 변수와 클래스 간 관계를 파악하여 이를 알고리즘에 적용하여야 원하는 예측 결과를 얻을 수 있다.
2. 적절한 k선택이 필요하다
3. 훈련 단계는 짧지만 예측 단계에서 상대적으로 느리다. 데이터가 많아지면 분류 단계가 느려진다.
4. 명목 데이터 및 누락 데이터를 위한 추가 처리가 필요하다 -> '더미 코딩(Dummy coding)' 사용 가능

![image-20210420013904008](C:\Users\yeahaluu\AppData\Roaming\Typora\typora-user-images\image-20210420013904008.png)



## 구현시 주의점

거리기반 모델이므로 표준화가 필요하다.

아래와 같이 A변수와 B변수의 분포가 다를 경우 각 변수의 차이를 해석하기 어렵다. 따라서, 변수 값을 표준 범위로 재조정하기 위해 정규화를 적용한다.

![image-20210420014125825](C:\Users\yeahaluu\AppData\Roaming\Typora\typora-user-images\image-20210420014125825.png)



정규화 방법으로는 크게 두가지가 있다

### 1. 최소-최대 정규화 (min-max normalization)

변수 x의 범위를 0%에서 100%까지로 나타낸다

![image-20210420014231719](C:\Users\yeahaluu\AppData\Roaming\Typora\typora-user-images\image-20210420014231719.png)

### 2. z-점수 표준화 (z-score standardization)

변수의 범위를 평균의 위 또는 아래로 몇 표준편차만큼 떨어져 있는지 관점으로 확대/축소. 

![image-20210420014324707](C:\Users\yeahaluu\AppData\Roaming\Typora\typora-user-images\image-20210420014324707.png)



실무에서는 z-점수 표준화를 더 많이 사용한다. 
그 이유는 최소-최대 정규화를 이용했을 때, 예측할 데이터셋에서 최솟값과 최대값이 이 범위를 넘어나는 경우가 생길 수 있기 때문. (훈련 데이터 셋의 최대값은 250이었지만 예측할 미래의 데이터는 250을 넘을 수 있다) 하지만 범위가 한정된 경우엔 최소-최대 정규화를 사용해도 된다.





[참고] https://firework-ham.tistory.com/27

[참고] https://m.blog.naver.com/bestinall/221760380344